\begin{center}
    \begin{tikzpicture}[scale=0.76,every node/.style={scale=0.76}]
        %%%%%%%%%% Nodi %%%%%%%%%%
        \foreach \y in {0,1.5,...,4.5}
            \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (0,\y) {A};
            
        \foreach \y in {0,1.5,3}
            \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (1.5,\y) {ESC};
            
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (1.5,4.5) {FLAG};

        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (3,4.5) {B};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (3,3) {B};

        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (3,1.5) {FLAG};

        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (3,0) {ESC};

        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (4.5,1.5) {B};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (4.5,0) {B};

        \draw[->,>=stealth] (4,4.5) -- (6,4.5);
        \draw[->,>=stealth] (4,3) -- (6,3);
        \draw[->,>=stealth] (5.5,1.5) -- (6,1.5);
        \draw[->,>=stealth] (5.5,0) -- (6,0);

        \foreach \y in {0,1.5,...,4.5}
            \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (7,\y) {A};

        \foreach \y in {0,1.5,...,4.5}
            \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (8.5,\y) {ESC};

        \foreach \y in {0,1.5,3}
            \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (10,\y) {ESC};

        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (10,4.5) {FLAG};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (11.5,1.5) {ESC};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (11.5,0) {ESC};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (11.5,3) {B};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (11.5,4.5) {B};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (13,1.5) {FLAG};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (13,0) {ESC};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (14.5,1.5) {B};
        \node[rectangle,draw,minimum width=1.3cm,minimum height=1.3cm] at (14.5,0) {B};

        %%%%%%%%% Testo %%%%%%%%%%
        \draw (0,5.5) -- node[above] {Original characters} (3,5.5);
        \draw (7,5.5) -- node[above] {After stuffing} (11.5,5.5);

        %%%%%%%% Legenda %%%%%%%%%
        \draw (0,7) -- (14.5,7);
        \draw (0,8.3) -- (14.5,8.3);
        
        \foreach \x in {0,1.3,3.1,11.4,13.2,14.5}
            \draw (\x,7) -- ++(0,1.3);

        %%%%%%%%% Testo %%%%%%%%%%
        \node at (0.65,7.65) {FLAG};
        \node at (2.2,7.65) {Header};
        \node at (7.25,7.65) {Payload field};
        \node at (12.3,7.65) {Trailer};
        \node at (13.85,7.65) {FLAG};
    \end{tikzpicture}
\end{center}